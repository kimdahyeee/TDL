# static

> 잘 모르고 `static`을 사용한다면, 성능이 안좋거나, 오류를 발생시키는 시스템이 될 수도 있다. 잘 알고 사용하자!

## `static`의 특징
1. 변수를 `static` 으로 선언하면 **클래스 변수** 라고 한다.

   다른 인스턴스를 생성하더라도, 모든 객체가 **클래스 변수**에 대해서는 **동일한 주소를 참조**한다는 의미!
   
   `static` 변수는 클래스가 최초로 로딩될 때 수행되므로, 생성자 실행과 상관없이 수행된다.

2. **GC의 대상이 아니다.**

   한 번 생성되면 삭제되지 않는다!

   **메모리 릭**이 발생할 수 있다.

## `static` 잘 사용하기
1. 자주 사용하고 절대 변하지 않는 변수는 `static final`으로 선언하자.

   공유되어 사용되기 때문에 `final`로 선언하면 안전하다.

2. 공통으로 사용(공유)되는 데이터나, 설정 파일 정보 등 `static`으로 선언하자.
   
   클래스가 로딩될 때 **한 번만 생성**되므로 성능상 이점이 

   > 이 때, 주의할 점은 데이터가 잘 못 변경된다면, 잘못된 동작을 할 수 있기 때문에 주의해야 한다.
   
   > 서로 다른 JVM 에서 싱크가 맞지 않는 문제가 발생할 수 있다. (이 때엔 `mem-cached` 나 `EhCache` 를 사용하자)
   > 
   > 하나의 JVM 에서만 공유되기 때문 !
   
3. GC 의 대상이 아니기 때문에 **메모리 릭**에 주의하자.

   `ArrayList` 나 `Vector` 와 같은 `Collection` 객체를 `static` 선언한다면, `OutOfMemoryError` 가 발생할 수 있다.

4. 항상 변하는 값에 대해서는 `static` 으로 선언하면 안된다.

   변하는 값에 `static` 을 사용한다면, 스레드 간의 동기화를 주의해야 한다. (해당 값에 접근하는 메서드에 `synchronized` 선언 필요)

### **메모리 릭**이란 ?
더 이상 사용 가능한 메모리가 없어지는 현상

`static` 과 `Collection` 을 함께 잘 못 사용하는 경우에 **메모리 릭**이 발생할 수 있다.

GC 가 되지 않기 때문에 !!

**메모리 릭 원인은 HeapDump 라는 파일을 통해 확인 가능하다.**

> 릭이 발생했을 때 가장 크게 나타나는 현상은 **사용 가능한 메모리가 적어지는 것**이다.

## 참고
- 자바 성능 튜닝 이야기